<!DOCTYPE html>
<html lang="en"><meta charset="utf-8">
<title>Think of Your Environment | nevstokes.com</title>

<link rel="preload" as="font" href="/fonts/quicksand-300-latin-ext.woff2" type="font/woff2" crossorigin="anonymous">

<link rel="canonical" href="https://nevstokes.com/blog/2020-07-05-environment/" />



<link rel="stylesheet" href="/css/style.css">
<link rel="stylesheet" href="/css/syntax.css">

<meta name="description" content="Personal site">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, user-scalable=yes, viewport-fit=cover">
<a href="#content">Skip to main content</a>

    <main><header>
    <a href="/">nevstokes.com</a>
    <nav>
        
            <a title="Blog" href="/blog/">Blog</a>
        
            <a title="About Me" href="/page/about-me/">About Me</a>
        
            <a title="Accessibility" href="/page/accessibility/">Accessibility</a>
        
            <a title="Colophon" href="/page/colophon/">Colophon</a>
        
    </nav>
</header>


    <article id="content">
        <h1>Think of Your Environment</h1>

        
            <div class="meta">
    <p><svg aria-label="Posted on"><use xlink:href="/symbol-defs.svg#icon-calendar"></use></svg> Wednesday, July 8, 2020</p>

    <p><svg aria-label="Reading time"><use xlink:href="/symbol-defs.svg#icon-watch"></use></svg> 3 minutes</p>
</div>

        

        <figure>
    <blockquote>Knowing is not understanding. There is a great difference between knowing and understanding: you can know a lot about something and not really understand it.</blockquote>
    <figcaption>
        &mdash; Charles F. Kettering
    </figcaption>
</figure>

<p>A dotenv file such as <code>.env</code> can be handy for local development. It is a substitute for a real environment in which the application will actually be operating; they should never really be used in a production environment.</p>
<h2 id="environments-and-dotenv-files">Environments and dotenv files</h2>
<p>As per best practice as described in Heroku&rsquo;s <a href="https://12factor.net/config">12 Factor App</a> methodology, only runtime configuration parameters that differ per-environment should be included in a dotenv file; it shouldn&rsquo;t be polluted with values that are intended for the build or deployment processes.</p>
<p>Before the days of the Cloud, containers and ephemeral infrastructure, heavy-duty configuration management tools would take care of setting up the production environments. This made things tricky to manage for local development, unless you had the luxury of working on a single project or were using virtual machines. These VMs were slow and cumbersome so devs started using these dotenv files to easily isolate and manage these variables.</p>
<p>Libraries are commonly used to parse these dotenv files and make the variables in them available via the environment for languages to use, such as those for <a href="https://packagist.org/packages/symfony/dotenv">PHP</a>, <a href="https://www.npmjs.com/package/dotenv">Node.js</a> or <a href="https://pypi.org/project/python-dotenv/">Python</a>.</p>
<p>We&rsquo;ve moved on a lot in the last decade but the use of dotenv files still persists. The reasoning behind them sometimes gets lost, which means we run the risk of descending into dogmatic cargo culting. They are a workaround, not the actual way to achieve the original goal of the seperation of code and config.</p>
<p>Indeed, to achieve this seperation of concerns, a dotenv file should never be checked into source control. Instead, templated versions &ndash; such as <code>.env.dist</code> or <code>.env.local</code> &ndash; which don&rsquo;t include sensitive information are committed instead. Sharing and populating the actual values is an extra step to be built in to the development process &ndash; not to mention the work involved in keeping these details up to date.</p>
<p>Some get around this by committing encrypted verions of dotenv files, maybe employing the <code>git smudge</code> and <code>git clean</code> filters to handle this work transparently. Others rely on manual processes or scripted solutions to get the same effect.</p>
<h2 id="envfiles">envfiles</h2>
<p>Similar to a dotenv file but for a different context. Used to pass variables from the existing environment to a container or set new ones.</p>
<p>docker-compose automatically use .env</p>
<h2 id="alternatives">Alternatives</h2>
<p>direnv &ndash; requires installation (<a href="https://direnv.net/">https://direnv.net/</a>) rather than a library &ndash; can be coupled with encryption such as ssh-vault so that the variables can be safely shared. Sets up a per-project environment.</p>
<p>All that being said, the use of environment variables in this way would ideally be limited &ndash; if used at all. Any process running will have access; real risk of credential leakage.
Instead, if at all possible, template out configuration files with values from a secure storage solution with granular access levels and audited leased access.</p>

    </article>

    
    <nav>
    
        <a href="https://nevstokes.com/blog/2020-06-28-out-with-the-old/" title="Out With the Old">&laquo; Previous Post</a>
    
    
        <a href="https://nevstokes.com/blog/2020-07-21-herring-road/" title="The Herring Road">Next Post &raquo;</a>
    
    </nav>
    
<footer>
    <ul class="container" aria-label="Social Links">
        <li>
            <a href="https://twitter.com/nevstokes" title="Twitter" target="_blank" rel="noopener noreferrer">
                <svg><use xlink:href="/symbol-defs.svg#icon-twitter"></use></svg>
                <span>My Twitter Feed</span>
            </a>
        </li>
        <li>
            <a href="https://keybase.io/nevstokes" title="Keybase" target="_blank" rel="noopener noreferrer">
                <svg><use xlink:href="/symbol-defs.svg#icon-keybase"></use></svg>
                <span>My Keybase Identity</span>
            </a>
        </li>
        <li>
            <a href="https://github.com/nevstokes" title="GitHub" target="_blank" rel="noopener noreferrer">
                <svg><use xlink:href="/symbol-defs.svg#icon-github"></use></svg>
                <span>My GitHub Repositories</span>
            </a>
        </li>
        <li>
            <a href="https://linkedin.com/in/nevstokes" title="LinkedIn" target="_blank" rel="noopener noreferrer">
                <svg><use xlink:href="/symbol-defs.svg#icon-linkedin"></use></svg>
                <span>My LinkedIn Profile</span>
            </a>
        </li>
        <li>
            <a href="https://stackoverflow.com/users/224639/nev-stokes" title="StackOverflow" target="_blank" rel="noopener noreferrer">
                <svg><use xlink:href="/symbol-defs.svg#icon-stackoverflow"></use></svg>
                <span>My StackOverflow Activity</span>
            </a>
        </li>
        <li>
            <a href="https://www.strava.com/athletes/nevstokes" title="Strava" target="_blank" rel="noopener noreferrer">
                <svg><use xlink:href="/symbol-defs.svg#icon-strava"></use></svg>
                <span>My Strava Activities</span>
            </a>
        </li>
        <li>
            <a href="https://nevstokes.com/index.xml" title="RSS" target="_blank" rel="noopener noreferrer">
                <svg><use xlink:href="/symbol-defs.svg#icon-rss"></use></svg>
                <span>This Blog's RSS Feed</span>
            </a>
        </li>
    </ul>
</footer>
</main>
</html>
